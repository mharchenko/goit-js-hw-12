{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46807099-cbb80e6feaa2f2d0498acb57e';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet page = 1;\nlet query = '';\n\nexport async function fetchImages(searchQuery) {\n  query = searchQuery;\n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n\n  try {\n    const response = await axios.get(url);\n    page++;\n    return {\n      images: response.data.hits,\n      totalHits: response.data.totalHits,\n    };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n\nexport function resetPage() {\n  page = 1;\n}\n\nexport function getCurrentPage() {\n  return page;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryElement = document.querySelector('.gallery');\n\nexport function clearGallery() {\n  galleryElement.innerHTML = '';\n}\n\nexport function renderImages(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <a href=\"${largeImageURL}\" class=\"gallery__item\">\n        <img class=\"gallery-link\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p class=\"text-item\"><b>Likes:</b> ${likes}</p>\n          <p class=\"text-item\"><b>Views:</b> ${views}</p>\n          <p class=\"text-item\"><b>Comments:</b> ${comments}</p>\n          <p class=\"text-item\"><b>Downloads:</b> ${downloads}</p>\n        </div>\n      </a>\n    `\n    )\n    .join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', markup);\n  new SimpleLightbox('.gallery a').refresh();\n}\n","import { fetchImages, resetPage, getCurrentPage } from './js/pixabay-api.js';\nimport { renderImages, clearGallery } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'loaders.css/loaders.css';\n\nconst searchForm = document.querySelector('#search-form');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\n\nlet currentQuery = '';\nlet isLoading = false;\nlet totalHits = 0;\nlet throttleTimeout = null;\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.classList.remove('hidden');\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.classList.add('hidden');\n}\n\nasync function loadImages() {\n  if (isLoading) return;\n  isLoading = true;\n  showLoader();\n\n  try {\n    const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n    hideLoader();\n    isLoading = false;\n\n    if (newTotalHits !== undefined) {\n      totalHits = newTotalHits;\n    }\n\n    if (images.length === 0 || getCurrentPage() * 15 >= totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      renderImages(images);\n\n      if (getCurrentPage() * 15 < totalHits) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n      }\n    }\n  } catch (error) {\n    hideLoader();\n    isLoading = false;\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later!',\n    });\n  }\n}\nfunction handleScroll() {\n  if (throttleTimeout) return;\n\n  throttleTimeout = setTimeout(() => {\n    throttleTimeout = null;\n\n    if (\n      window.innerHeight + window.scrollY >=\n        document.documentElement.scrollHeight - 100 &&\n      !isLoading\n    ) {\n      loadImages();\n    }\n  }, 2000);\n}\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  const query = event.currentTarget.elements.query.value.trim();\n\n  if (!query) {\n    iziToast.error({ title: 'Error', message: 'Please enter a search term!' });\n    return;\n  }\n\n  currentQuery = query;\n  clearGallery();\n  resetPage();\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n    hideLoader();\n\n    if (newTotalHits !== undefined) {\n      totalHits = newTotalHits;\n    }\n\n    if (images.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      renderImages(images);\n\n      if (images.length < totalHits) {\n        showLoadMoreButton();\n      }\n    }\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later!',\n    });\n  }\n});\nloadMoreButton.addEventListener('click', loadImages);\nwindow.addEventListener('scroll', handleScroll);\n"],"names":["API_KEY","BASE_URL","page","query","fetchImages","searchQuery","url","response","axios","error","resetPage","getCurrentPage","galleryElement","clearGallery","renderImages","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","searchForm","loader","loadMoreButton","currentQuery","isLoading","totalHits","throttleTimeout","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","loadImages","newTotalHits","iziToast","handleScroll","event"],"mappings":"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"}