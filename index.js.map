{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// import axios from 'axios';\n\n// const API_KEY = '46807099-cbb80e6feaa2f2d0498acb57e';\n// const BASE_URL = 'https://pixabay.com/api/';\n\n// let page = 1;\n// let query = '';\n\n// export async function fetchImages(searchQuery) {\n//   query = searchQuery;\n//   const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(\n//     query\n//   )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n\n//   try {\n//     const response = await axios.get(url);\n//     page++;\n//     return {\n//       images: response.data.hits,\n//       totalHits: response.data.totalHits,\n//     };\n//   } catch (error) {\n//     console.error('Error fetching images:', error);\n//     throw error;\n//   }\n// }\n\n// export function resetPage() {\n//   page = 1;\n// }\n\n// export function getCurrentPage() {\n//   return page;\n// }\n// --------------------зміни-----------------------------\nimport axios from 'axios';\n\nconst API_KEY = '46807099-cbb80e6feaa2f2d0498acb57e';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet page = 1;\nlet query = '';\n\nexport async function fetchImages(searchQuery) {\n  query = searchQuery;\n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n\n  try {\n    const response = await axios.get(url);\n    page++;\n    return {\n      images: response.data.hits,\n      totalHits: response.data.totalHits,\n    };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n\nexport function resetPage() {\n  page = 1;\n}\n\nexport function getCurrentPage() {\n  return page;\n}\n","// import SimpleLightbox from 'simplelightbox';\n// import 'simplelightbox/dist/simple-lightbox.min.css';\n\n// const galleryElement = document.querySelector('.gallery');\n\n// export function clearGallery() {\n//   galleryElement.innerHTML = '';\n// }\n\n// export function renderImages(images) {\n//   const markup = images\n//     .map(\n//       ({\n//         webformatURL,\n//         largeImageURL,\n//         tags,\n//         likes,\n//         views,\n//         comments,\n//         downloads,\n//       }) => `\n//       <a href=\"${largeImageURL}\" class=\"gallery__item\">\n//         <img class=\"gallery-link\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n//         <div class=\"info\">\n//           <p class=\"text-item\"><b>Likes:</b> ${likes}</p>\n//           <p class=\"text-item\"><b>Views:</b> ${views}</p>\n//           <p class=\"text-item\"><b>Comments:</b> ${comments}</p>\n//           <p class=\"text-item\"><b>Downloads:</b> ${downloads}</p>\n//         </div>\n//       </a>\n//     `\n//     )\n//     .join('');\n\n//   galleryElement.insertAdjacentHTML('beforeend', markup);\n//   new SimpleLightbox('.gallery a').refresh();\n// }\n// --------------------зміни------------------------------\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryElement = document.querySelector('.gallery');\nlet lightbox = new SimpleLightbox('.gallery a');\n\nexport function clearGallery() {\n  galleryElement.innerHTML = '';\n}\n\nexport function renderImages(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <a href=\"${largeImageURL}\" class=\"gallery__item\">\n        <img class=\"gallery-link\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p class=\"text-item\"><b>Likes:</b> ${likes}</p>\n          <p class=\"text-item\"><b>Views:</b> ${views}</p>\n          <p class=\"text-item\"><b>Comments:</b> ${comments}</p>\n          <p class=\"text-item\"><b>Downloads:</b> ${downloads}</p>\n        </div>\n      </a>\n    `\n    )\n    .join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n","//import { fetchImages, resetPage, getCurrentPage } from './js/pixabay-api.js';\n// import { renderImages, clearGallery } from './js/render-functions.js';\n// import iziToast from 'izitoast';\n// import 'izitoast/dist/css/iziToast.min.css';\n// import 'loaders.css/loaders.css';\n\n// const searchForm = document.querySelector('#search-form');\n// const loader = document.querySelector('.loader');\n// const loadMoreButton = document.querySelector('.load-more');\n\n// let currentQuery = '';\n// let isLoading = false;\n// let totalHits = 0;\n// let throttleTimeout = null;\n\n// function showLoader() {\n//   loader.classList.remove('hidden');\n// }\n\n// function hideLoader() {\n//   loader.classList.add('hidden');\n// }\n\n// function showLoadMoreButton() {\n//   loadMoreButton.classList.remove('hidden');\n// }\n\n// function hideLoadMoreButton() {\n//   loadMoreButton.classList.add('hidden');\n// }\n\n// async function loadImages() {\n//   if (isLoading) return;\n//   isLoading = true;\n//   showLoader();\n\n//   try {\n//     const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n//     hideLoader();\n//     isLoading = false;\n\n//     if (newTotalHits !== undefined) {\n//       totalHits = newTotalHits;\n//     }\n\n//     if (images.length === 0 || getCurrentPage() * 15 >= totalHits) {\n//       hideLoadMoreButton();\n//       iziToast.info({\n//         title: 'Info',\n//         message: \"We're sorry, but you've reached the end of search results.\",\n//       });\n//     } else {\n//       renderImages(images);\n\n//       if (getCurrentPage() * 15 < totalHits) {\n//         showLoadMoreButton();\n//       } else {\n//         hideLoadMoreButton();\n//       }\n//     }\n//   } catch (error) {\n//     hideLoader();\n//     isLoading = false;\n//     iziToast.error({\n//       title: 'Error',\n//       message: 'Something went wrong. Please try again later!',\n//     });\n//   }\n// }\n// function handleScroll() {\n//   if (throttleTimeout) return;\n\n//   throttleTimeout = setTimeout(() => {\n//     throttleTimeout = null;\n\n//     if (\n//       window.innerHeight + window.scrollY >=\n//         document.documentElement.scrollHeight - 100 &&\n//       !isLoading\n//     ) {\n//       loadImages();\n//     }\n//   }, 2000);\n// }\n// searchForm.addEventListener('submit', async event => {\n//   event.preventDefault();\n//   const query = event.currentTarget.elements.query.value.trim();\n\n//   if (!query) {\n//     iziToast.error({ title: 'Error', message: 'Please enter a search term!' });\n//     return;\n//   }\n\n//   currentQuery = query;\n//   clearGallery();\n//   resetPage();\n//   hideLoadMoreButton();\n//   showLoader();\n\n//   try {\n//     const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n//     hideLoader();\n\n//     if (newTotalHits !== undefined) {\n//       totalHits = newTotalHits;\n//     }\n\n//     if (images.length === 0) {\n//       iziToast.info({\n//         title: 'Info',\n//         message:\n//           'Sorry, there are no images matching your search query. Please try again!',\n//       });\n//     } else {\n//       renderImages(images);\n\n//       if (images.length < totalHits) {\n//         showLoadMoreButton();\n//       }\n//     }\n//   } catch (error) {\n//     hideLoader();\n//     iziToast.error({\n//       title: 'Error',\n//       message: 'Something went wrong. Please try again later!',\n//     });\n//   }\n// });\n// loadMoreButton.addEventListener('click', loadImages);\n// window.addEventListener('scroll', handleScroll);\n\n// -----------------------зміни-------------------------------\n\nimport { fetchImages, resetPage, getCurrentPage } from './js/pixabay-api.js';\nimport { renderImages, clearGallery } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'loaders.css/loaders.css';\n\nconst searchForm = document.querySelector('#search-form');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\n\nlet currentQuery = '';\nlet totalHits = 0;\nlet isFirstLoad = true;\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.classList.remove('hidden');\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.classList.add('hidden');\n}\n\nasync function onLoadMore() {\n  loadMoreButton.disabled = true;\n\n  try {\n    const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n\n    if (newTotalHits !== undefined) {\n      totalHits = newTotalHits;\n    }\n\n    renderImages(images);\n\n    if (getCurrentPage() * 15 >= totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    const card = document.querySelector('.gallery .gallery__item');\n    if (card) {\n      const cardHeight = card.getBoundingClientRect().height;\n      window.scrollBy({\n        left: 0,\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later!',\n    });\n  } finally {\n    loadMoreButton.disabled = false;\n  }\n}\n\nfunction scrollOnLoad() {\n  if (isFirstLoad) {\n    const cardGallery = document.querySelector('.gallery');\n    if (cardGallery) {\n      const cardGalleryHeight = cardGallery.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardGalleryHeight * 2,\n        behavior: 'smooth',\n      });\n      isFirstLoad = false;\n    }\n  }\n}\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  const query = event.currentTarget.elements.query.value.trim();\n\n  if (!query) {\n    iziToast.error({ title: 'Error', message: 'Please enter a search term!' });\n    return;\n  }\n\n  currentQuery = query;\n  clearGallery();\n  resetPage();\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n    hideLoader();\n\n    if (newTotalHits !== undefined) {\n      totalHits = newTotalHits;\n    }\n\n    if (images.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      renderImages(images);\n      if (images.length < totalHits) {\n        showLoadMoreButton();\n      }\n      scrollOnLoad();\n    }\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later!',\n    });\n  }\n});\n\nloadMoreButton.addEventListener('click', onLoadMore);\n\n// ---------------infinite scroll-------------------------------\n\n// import { fetchImages, resetPage, getCurrentPage } from './js/pixabay-api.js';\n// import { renderImages, clearGallery } from './js/render-functions.js';\n// import iziToast from 'izitoast';\n// import 'izitoast/dist/css/iziToast.min.css';\n// import 'loaders.css/loaders.css';\n\n// const searchForm = document.querySelector('#search-form');\n// const loader = document.querySelector('.loader');\n// const sentinel = document.createElement('div');\n// sentinel.classList.add('sentinel');\n// document.querySelector('main').appendChild(sentinel);\n\n// let currentQuery = '';\n// let totalHits = 0;\n\n// function showLoader() {\n//   loader.classList.remove('hidden');\n// }\n\n// function hideLoader() {\n//   loader.classList.add('hidden');\n// }\n\n// async function loadImages() {\n//   try {\n//     const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n\n//     if (newTotalHits !== undefined) {\n//       totalHits = newTotalHits;\n//     }\n\n//     renderImages(images);\n\n//     if (getCurrentPage() * 15 >= totalHits) {\n//       observer.unobserve(sentinel);\n//       iziToast.info({\n//         title: 'Info',\n//         message: \"We're sorry, but you've reached the end of search results.\",\n//       });\n//     } else {\n//       const card = document.querySelector('.gallery .gallery__item');\n//       if (card) {\n//         const cardHeight = card.getBoundingClientRect().height;\n//         window.scrollBy({\n//           left: 0,\n//           top: cardHeight * 2,\n//           behavior: 'smooth',\n//         });\n//       }\n//     }\n//   } catch (error) {\n//     iziToast.error({\n//       title: 'Error',\n//       message: 'Something went wrong. Please try again later!',\n//     });\n//   }\n// }\n\n// function handlePagination(entries, observer) {\n//   entries.forEach(entry => {\n//     if (entry.isIntersecting) {\n//       loadImages();\n//     }\n//   });\n// }\n\n// const observer = new IntersectionObserver(handlePagination, {\n//   root: null,\n//   rootMargin: '300px',\n//   threshold: 0,\n// });\n\n// searchForm.addEventListener('submit', async event => {\n//   event.preventDefault();\n//   const query = event.currentTarget.elements.query.value.trim();\n\n//   if (!query) {\n//     iziToast.error({ title: 'Error', message: 'Please enter a search term!' });\n//     return;\n//   }\n\n//   currentQuery = query;\n//   clearGallery();\n//   resetPage();\n//   hideLoader();\n//   showLoader();\n\n//   try {\n//     const { images, totalHits: newTotalHits } = await fetchImages(currentQuery);\n//     hideLoader();\n\n//     if (newTotalHits !== undefined) {\n//       totalHits = newTotalHits;\n//     }\n\n//     if (images.length === 0) {\n//       iziToast.info({\n//         title: 'Info',\n//         message:\n//           'Sorry, there are no images matching your search query. Please try again!',\n//       });\n//     } else {\n//       renderImages(images);\n//       observer.observe(sentinel);\n//     }\n//   } catch (error) {\n//     hideLoader();\n//     iziToast.error({\n//       title: 'Error',\n//       message: 'Something went wrong. Please try again later!',\n//     });\n//   }\n// });\n"],"names":["API_KEY","BASE_URL","page","query","fetchImages","searchQuery","url","response","axios","error","resetPage","getCurrentPage","galleryElement","lightbox","SimpleLightbox","clearGallery","renderImages","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","loader","loadMoreButton","currentQuery","totalHits","isFirstLoad","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","onLoadMore","newTotalHits","iziToast","card","cardHeight","scrollOnLoad","cardGallery","cardGalleryHeight","event"],"mappings":"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"}